---
import BaseLayout from "../layouts/BaseLayout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import CTA from "../components/CTA.astro";
import { getTeamVoices } from "../data/cms";

const teamVoices = await getTeamVoices();
const values = [
  {
    title: 'Nachhaltigkeit',
    description: 'Wir reparieren statt wegzuwerfen und reduzieren so Müll, CO₂ und Neuanschaffungen.'
  },
  {
    title: 'Gemeinschaft',
    description: 'Alle arbeiten auf Augenhöhe zusammen – Gäste, Helfende und Neugierige.'
  },
  {
    title: 'Wissen teilen',
    description: 'Wir zeigen Tricks und Handgriffe, damit Reparaturen auch zuhause funktionieren.'
  },
  {
    title: 'Niedrige Hürden',
    description: 'Die Teilnahme ist kostenlos, Spenden sind willkommen – jede:r darf einfach vorbeikommen.'
  }
];
---

<BaseLayout title="Über uns – Repair Café Leonberg" description="Erfahre mehr über das Team und die Vision hinter dem Repair Café Leonberg.">
  <Header />

  <main class="bg-slate-100 py-12 md:py-16">
    <section class="pb-12">
      <div class="container">
        <div class="mx-auto max-w-4xl text-center">
          <span class="inline-flex items-center gap-2 rounded-full bg-white px-4 py-1 text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">
            Über uns
          </span>
          <h1 class="mt-5 font-display text-4xl font-extrabold text-slate-900 md:text-5xl">
            Gemeinsam reparieren, voneinander lernen
          </h1>
          <p class="mt-3 text-base text-slate-600">
            Wir sind Ehrenamtliche aus Leonberg und Umgebung, die Werkzeuge lieben, Wissen teilen und Geräte vor der Tonne retten.
          </p>
        </div>
      </div>
    </section>

    <section class="pb-12">
      <div class="container">
        <div class="grid gap-8 lg:grid-cols-2 lg:items-center">
          <div class="relative overflow-hidden rounded-[32px] bg-white/90 shadow-xl shadow-slate-900/10">
            <div class="aspect-[4/3] w-full bg-gradient-to-br from-slate-200 via-slate-300 to-slate-200"></div>
            <div class="absolute inset-0 flex flex-col items-center justify-center gap-3 bg-slate-900/70 text-center text-white">
              <span class="rounded-full border border-white/30 px-4 py-1 text-xs uppercase tracking-[0.32em]">Teamgeist</span>
              <p class="max-w-sm text-lg font-semibold">Hier könnte ein großes Teamfoto stehen – lachende Gesichter, Werkzeuge in der Hand und jede Menge gute Laune.</p>
            </div>
          </div>

          <div class="space-y-8">
            <div class="rounded-3xl bg-white p-8 shadow-lg shadow-slate-900/5">
              <h2 class="font-display text-2xl font-semibold text-slate-900">Unsere Mission</h2>
              <p class="mt-4 text-sm text-slate-600">
                Reparieren ist mehr als Technik. Es ist Gemeinschaft, Nachhaltigkeit und Empowerment. Im Repair Café Leonberg bringen wir Menschen zusammen, die ihre Lieblingsgeräte behalten, Ressourcen schonen und voneinander lernen wollen. Egal ob Sie Erfahrung mitbringen oder einfach neugierig sind – bei uns sind Sie willkommen.
              </p>
              <p class="mt-4 text-sm text-slate-600">
                Jede Veranstaltung wird von einem Team aus Elektronik-, Textil- und Fahrradbegeisterten vorbereitet. Dazu kommen Gastgeber:innen, die für Kaffee und eine freundliche Atmosphäre sorgen.
              </p>
            </div>

          </div>
        </div>
      </div>
    </section>

    <section class="pb-12">
      <div class="container">
        <div class="mx-auto max-w-3xl text-center">
          <span class="inline-flex items-center gap-2 rounded-full bg-white px-4 py-1 text-xs font-semibold uppercase tracking-[0.32em] text-brand-600">
            Unsere Werte
          </span>
          <h2 class="mt-4 font-display text-3xl font-semibold text-slate-900 md:text-4xl">Was uns antreibt</h2>
          <p class="mt-3 text-sm text-slate-600">
            Diese Grundsätze begleiten uns bei jedem Reparaturtermin – und wir freuen uns über alle, die sie mittragen.
          </p>
        </div>
        <div class="mt-8 grid gap-5 md:grid-cols-2 xl:grid-cols-4">
          {values.map((value) => (
            <div class="rounded-3xl border border-slate-200 bg-white p-6 shadow-lg shadow-slate-900/5 dark:border-slate-700/60 dark:bg-slate-900/60">
              <h3 class="font-display text-lg font-semibold text-slate-900 dark:text-white">{value.title}</h3>
              <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">{value.description}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <section class="pb-12">
      <div class="container">
        <div
          class="rounded-3xl bg-white p-8 shadow-lg shadow-slate-900/5"
          data-team-carousel
        >
          <div class="flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-[0.32em] text-brand-600">Teamstimmen</p>
              <h2 class="mt-2 font-display text-3xl font-semibold text-slate-900 md:text-4xl">Warum wir dabei sind</h2>
            </div>
            <div class="flex items-center gap-3">
              <button
                type="button"
                class="inline-flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:border-brand-500 hover:text-brand-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-500"
                aria-label="Vorherige Stimme"
                data-carousel-prev
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6" /></svg>
              </button>
              <button
                type="button"
                class="inline-flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:border-brand-500 hover:text-brand-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-500"
                aria-label="Nächste Stimme"
                data-carousel-next
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 6l6 6-6 6" /></svg>
              </button>
            </div>
          </div>

          <div class="mt-6 overflow-hidden" data-carousel-viewport>
            <ul class="flex transition-transform duration-500 ease-out" data-carousel-track>
              {teamVoices.map((voice, index) => (
                <li
                  class="w-full flex-shrink-0"
                  data-carousel-slide
                  aria-hidden={index === 0 ? 'false' : 'true'}
                >
                  <div class="grid gap-8 md:grid-cols-[minmax(0,230px)_1fr] md:items-center">
                    <div class="relative mx-auto flex h-52 w-52 items-center justify-center overflow-hidden rounded-[28px] bg-gradient-to-br from-brand-500 via-brand-600 to-sky-500 text-white shadow-xl shadow-brand-900/20">
                      {voice.portrait ? (
                        <>
                          <img
                            src={voice.portrait}
                            alt={voice.portraitAlt ?? `${voice.name} Portrait`}
                            class="absolute inset-0 h-full w-full object-cover"
                            loading="lazy"
                          />
                          <div class="absolute inset-0 bg-gradient-to-t from-slate-900/50 via-slate-900/10 to-transparent"></div>
                        </>
                      ) : (
                        <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),_transparent_60%)]"></div>
                      )}
                      <span class="relative text-center text-sm font-semibold leading-snug uppercase tracking-[0.24em] text-white/85">
                        {voice.name}
                        <br />
                        {voice.badge}
                      </span>
                    </div>
                    <div class="space-y-4">
                      <h3 class="font-display text-2xl font-semibold text-slate-900">{voice.name} – {voice.role}</h3>
                      <div class="relative rounded-2xl bg-slate-50 p-6 text-slate-700 shadow-inner shadow-white/40">
                        <span class="absolute -left-4 top-1 text-5xl font-black text-brand-500/35">“</span>
                        <blockquote class="relative z-[1] text-base italic leading-relaxed text-slate-700">{voice.quote}</blockquote>
                        <span class="absolute -right-4 bottom-0 text-5xl font-black text-brand-500/30">”</span>
                      </div>
                      <p class="text-sm text-slate-500">{voice.description}</p>
                    </div>
                  </div>
                </li>
              ))}
            </ul>
          </div>

          <div class="mt-6 flex items-center justify-center gap-2" role="tablist">
            {teamVoices.map((_, index) => (
              <button
                type="button"
                class="h-2.5 w-2.5 rounded-full bg-slate-300 transition-all data-[active=true]:w-6 data-[active=true]:bg-brand-600"
                aria-label={`Stimme ${index + 1}`}
                data-carousel-dot
                data-index={index}
              ></button>
            ))}
          </div>
        </div>
      </div>
    </section>

    <script is:inline>
      (() => {
        const root = document.querySelector('[data-team-carousel]');
        if (!root) return;

        const track = root.querySelector('[data-carousel-track]');
        const slides = Array.from(track?.querySelectorAll('[data-carousel-slide]') ?? []);
        const prev = root.querySelector('[data-carousel-prev]');
        const next = root.querySelector('[data-carousel-next]');
        const dots = Array.from(root.querySelectorAll('[data-carousel-dot]'));

        if (!track || slides.length === 0) return;

        let index = 0;

        const update = () => {
          track.setAttribute('style', `transform: translateX(-${index * 100}%);`);
          slides.forEach((slide, slideIndex) => {
            const isActive = slideIndex === index;
            slide.setAttribute('aria-hidden', String(!isActive));
            if (isActive) {
              slide.removeAttribute('tabindex');
            } else {
              slide.setAttribute('tabindex', '-1');
            }
          });
          dots.forEach((dot, dotIndex) => {
            dot.setAttribute('data-active', String(dotIndex === index));
          });
        };

        const setIndex = (value) => {
          const total = slides.length;
          index = (value + total) % total;
          update();
        };

        prev?.addEventListener('click', () => setIndex(index - 1));
        next?.addEventListener('click', () => setIndex(index + 1));

        dots.forEach((dot) => {
          dot.addEventListener('click', () => {
            const target = Number(dot.getAttribute('data-index'));
            if (!Number.isNaN(target)) {
              setIndex(target);
            }
          });
        });

        let resizeTimeout;
        window.addEventListener('resize', () => {
          window.clearTimeout(resizeTimeout);
          resizeTimeout = window.setTimeout(() => update(), 150);
        });

        update();
      })();
    </script>

    <section>
      <div class="container">
        <div class="rounded-3xl bg-brand-600 px-8 py-10 text-white shadow-xl shadow-brand-900/20">
          <div class="grid gap-8 lg:grid-cols-2 lg:items-center">
            <div class="space-y-4">
              <h2 class="font-display text-2xl font-semibold">Mach mit im Team</h2>
              <p class="text-sm text-white/85">
                Wir suchen immer helfende Hände – technisch versiert oder im Bereich Organisation, Kommunikation und Kaffee. Schreiben Sie uns, wenn Sie Lust haben, das Repair Café mitzugestalten.
              </p>
            </div>
            <div class="flex flex-wrap gap-3">
              <a href="mailto:kontakt@repaircafe-leonberg.de" class="inline-flex items-center justify-center rounded-full bg-white px-5 py-3 text-sm font-semibold text-brand-700 shadow-sm hover:bg-slate-100">
                Kontakt aufnehmen
              </a>
              <a href="/termine" class="inline-flex items-center justify-center rounded-full border border-white/70 px-5 py-3 text-sm font-semibold text-white hover:bg-white/15">
                Nächstes Treffen besuchen
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <CTA />
  <Footer />
</BaseLayout>
